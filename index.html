<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Imposter — Party Word Game</title>
<meta name="theme-color" content="#6d4aff" />
<style>
  :root{
    --bg:#0b0b12; --panel:#141426; --text:#f3f4f6; --muted:#a5a7b3;
    --primary:#6d4aff; --primary-2:#9a7dff; --accent:#00d4ff; --ok:#22c55e; --warn:#ef4444;
    --card:#171733; --border:#26264a;
  }
  *{box-sizing:border-box}
  html,body{height:100%}
  body{margin:0; font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Cantarell,"Helvetica Neue",Arial;
       color:var(--text); background:radial-gradient(1100px 600px at 20% -10%, #1c164f 0%, #0b0b12 60%)}
  .app{max-width:840px; margin:0 auto; padding:16px}
  header{position:sticky; top:0; z-index:10; backdrop-filter:saturate(1.2) blur(6px);
         background:linear-gradient(90deg, rgba(109,74,255,0.15), rgba(0,212,255,0.1)); border-bottom:1px solid var(--border)}
  .brand{display:flex; align-items:center; gap:.75rem; padding:12px 16px}
  .logo{width:36px; height:36px; border-radius:12px; background:linear-gradient(135deg,var(--primary),var(--accent)); box-shadow:0 8px 24px rgba(109,74,255,.35)}
  .title{font-weight:700; letter-spacing:.2px}
  .screen{display:none; animation:fade .22s ease}
  .screen.active{display:block}
  @keyframes fade{from{opacity:.01; transform:translateY(6px)} to{opacity:1; transform:none}}
  .card{background:linear-gradient(180deg, rgba(23,23,51,.9), rgba(20,20,38,.95));
        border:1px solid var(--border); border-radius:18px; padding:16px; box-shadow:0 12px 36px rgba(0,0,0,.35)}
  .card h2{margin:0 0 10px; font-size:1.1rem}
  .sub{color:var(--muted); font-size:.9rem}
  .grid{display:grid; gap:12px}
  @media(min-width:900px){.grid.cols-2{grid-template-columns:1fr 1fr}}
  label{display:block; color:var(--muted); font-size:.9rem; margin-bottom:6px}
  textarea,select,input[type=text],input[type=number]{
    width:100%; padding:12px 14px; border-radius:14px; border:1px solid var(--border); background:#0e0e1b; color:var(--text); outline:none;
  }
  textarea{min-height:120px; resize:vertical}
  .row{display:flex; gap:12px}
  .row>*{flex:1}
  .btn{display:inline-flex; align-items:center; justify-content:center; gap:.6rem; padding:12px 16px; border-radius:14px; border:1px solid var(--border);
       background:#0e0e1b; color:var(--text); cursor:pointer; transition:transform .04s ease, background .15s ease}
  .btn:hover{background:#12122a} .btn:active{transform:translateY(1px)}
  .btn.primary{background:linear-gradient(135deg, var(--primary), var(--primary-2)); border:none; color:white; box-shadow:0 10px 26px rgba(109,74,255,.35)}
  .btn.ghost{background:transparent; border:1px dashed var(--border)}
  .btn.ok{background:linear-gradient(135deg, #16a34a, #22c55e); border:none}
  .btn.warn{background:linear-gradient(135deg, #dc2626, #ef4444); border:none}
  .stack{display:flex; gap:8px; flex-wrap:wrap}
  .tags{display:flex; gap:8px; flex-wrap:wrap}
  .tag{padding:8px 10px; border-radius:999px; font-size:.85rem; background:#13132a; border:1px solid var(--border); color:#cbd5e1}
  .big{font-size:1.05rem}
  .divider{height:1px; background:var(--border); margin:14px 0}
  .center{display:flex; align-items:center; justify-content:center}
  .hero{background:linear-gradient(180deg, rgba(109,74,255,.18), rgba(0,212,255,.1)); border:1px solid var(--border);
        border-radius:22px; padding:20px; text-align:center; box-shadow:0 16px 40px rgba(109,74,255,.25)}
  .hero h1{margin:0 0 6px; font-size:1.35rem}
  .hero p{margin:0; color:#d1d5db}
  .foot{color:var(--muted); text-align:center; font-size:.85rem; margin:14px 0}
  /* Full-screen reveal */
  .overlay{position:fixed; inset:0; display:none; align-items:center; justify-content:center;
           background:radial-gradient(900px 520px at 50% -10%, rgba(109,74,255,.35), rgba(0,0,0,.75)); z-index:50}
  .overlay.show{display:flex}
  .reveal{width:min(560px,92vw); background:linear-gradient(180deg,#171733,#12122a); border:1px solid var(--border); border-radius:22px; padding:18px;
          box-shadow:0 20px 50px rgba(0,0,0,.45)}
  .reveal .who{font-weight:700}
  .roleBox{display:grid; gap:10px}
  .box{background:#12122a; border:1px dashed var(--border); border-radius:16px; padding:12px}
  .label{color:var(--muted); font-size:.9rem}
  .value{font-size:1.2rem; letter-spacing:.2px}
  .glow{background:linear-gradient(135deg, var(--primary), var(--accent)); -webkit-background-clip:text; background-clip:text; color:transparent; font-weight:800}
  .count{color:var(--muted); text-align:right; margin-top:6px}
</style>
</head>
<body>
<header>
  <div class="brand">
    <div class="logo"></div>
    <div>
      <div class="title">Imposter — party word game</div>
      <div class="sub">Pass-the-device, bold reveal, smooth round flow</div>
    </div>
  </div>
</header>

<div class="app">
  <!-- Welcome -->
  <section id="screen-welcome" class="screen active">
    <div class="hero">
      <h1>Ready to catch the Imposter?</h1>
      <p>Everyone gets the secret word — except the Imposter.</p>
      <div class="foot">Enter players, choose impostors, pick a category and difficulty, then reveal privately.</div>
      <div class="center" style="margin-top:12px">
        <button class="btn primary big" id="toSetup">Get started</button>
      </div>
    </div>
  </section>

  <!-- Setup -->
  <section id="screen-setup" class="screen">
    <div class="grid cols-2">
      <div class="card">
        <h2>Players</h2>
        <label for="names">Names (one per line)</label>
        <textarea id="names" placeholder="Muhammad
Aisha
Liam
Olivia
Noah"></textarea>
        <div class="row">
          <div>
            <label for="impostors">Number of impostors</label>
            <input id="impostors" type="number" min="1" value="1" />
            <div class="sub">Keep it spicy but fair.</div>
          </div>
          <div>
            <label for="starterPref">Starter</label>
            <select id="starterPref">
              <option value="random" selected>Random</option>
              <option value="first">First name</option>
            </select>
            <div class="sub">Who begins giving the first clue.</div>
          </div>
        </div>

        <div class="divider"></div>

        <h2>Word settings</h2>
        <div class="row">
          <div>
            <label for="category">Category</label>
            <select id="category">
              <option value="any" selected>Any</option>
              <option value="food">Food</option>
              <option value="sports">Sports</option>
              <option value="geography">Geography</option>
              <option value="technology">Technology</option>
              <option value="movies">Movies</option>
              <option value="music">Music</option>
              <option value="animals">Animals</option>
              <option value="household">Household</option>
            </select>
          </div>
          <div>
            <label for="difficulty">Difficulty</label>
            <select id="difficulty">
              <option value="easy" selected>Easy</option>
              <option value="medium">Medium</option>
              <option value="hard">Hard</option>
            </select>
          </div>
        </div>

        <div class="row">
          <div>
            <label for="timerSecs">Reveal auto-hide (seconds)</label>
            <input id="timerSecs" type="number" min="4" max="20" value="8" />
          </div>
          <div>
            <label for="roundHints">Imposter hint</label>
            <select id="roundHints">
              <option value="off" selected>Off</option>
              <option value="on">On (1 subtle hint)</option>
            </select>
          </div>
        </div>

        <div class="stack" style="margin-top:10px">
          <button class="btn primary" id="startRound">Start round</button>
          <button class="btn ghost" id="clearPlayers">Clear players</button>
        </div>

        <div id="setupStatus" class="tags" style="margin-top:10px"></div>
      </div>

      <div class="card">
        <h2>Round summary</h2>
        <div class="tags">
          <span class="tag"><span class="sub">Players:</span> <span id="tagPlayers">—</span></span>
          <span class="tag"><span class="sub">Impostors:</span> <span id="tagImps">—</span></span>
          <span class="tag"><span class="sub">Category:</span> <span id="tagCat">—</span></span>
          <span class="tag"><span class="sub">Difficulty:</span> <span id="tagDiff">—</span></span>
          <span class="tag"><span class="sub">Starter:</span> <span id="tagStarter">—</span></span>
        </div>

        <div class="divider"></div>

        <h2>Reveal</h2>
        <label for="revealPlayer">Select player</label>
        <select id="revealPlayer"></select>
        <div class="stack" style="margin-top:10px">
          <button class="btn ok" id="openReveal">Reveal privately</button>
          <button class="btn" id="toRound">Go to round</button>
        </div>

        <div class="divider"></div>

        <h2>How it works</h2>
        <ul class="sub" style="margin:0 0 10px 18px">
          <li>Non‑impostors see the secret word.</li>
          <li>Impostors see only the general topic (and an optional hint).</li>
          <li>Pass the device; reveal one player at a time.</li>
        </ul>
      </div>
    </div>
  </section>

  <!-- Live round -->
  <section id="screen-round" class="screen">
    <div class="card">
      <h2>Round in progress</h2>
      <div class="tags" style="margin-bottom:10px">
        <span class="tag">Starter: <strong id="roundStarter">—</strong></span>
        <span class="tag">Impostors: <strong id="roundImps">—</strong></span>
        <span class="tag">Category: <strong id="roundCat">—</strong></span>
        <span class="tag">Difficulty: <strong id="roundDiff">—</strong></span>
      </div>
      <div class="hero">
        <h1>One sentence clue each</h1>
        <p>Keep it specific enough to be helpful, vague enough to not give it away.</p>
        <div class="foot">After one loop of clues, pause and vote who’s the Imposter.</div>
      </div>
      <div class="center" style="margin-top:12px">
        <button class="btn ghost" id="backToSetup">New round</button>
      </div>
    </div>
  </section>
</div>

<!-- Full-screen private reveal -->
<div id="overlay" class="overlay">
  <div class="reveal">
    <div class="who" id="revealWho">—</div>
    <div class="roleBox" style="margin-top:8px">
      <div class="box">
        <div class="label">Your role</div>
        <div class="value glow" id="revealRole">—</div>
      </div>
      <div class="box">
        <div class="label" id="infoLabel">Your info</div>
        <div class="value" id="revealInfo">—</div>
      </div>
      <div class="box" id="hintBox" style="display:none">
        <div class="label">Hint</div>
        <div class="value" id="revealHint">—</div>
      </div>
    </div>
    <div class="count" id="revealCount">Auto-hide in 8s</div>
    <div class="stack" style="margin-top:10px; justify-content:flex-end">
      <button class="btn warn" id="closeReveal">Hide now</button>
    </div>
  </div>
</div>

<script>
/* =========================
   Data: Expanded word bank
   8 categories × 15 = 120
   ========================= */
const WORDS = [
  // Food
  {word:"Pizza",topic:"Food",category:"food",difficulty:"easy",hints:["Cheese","Slice"]},
  {word:"Burger",topic:"Food",category:"food",difficulty:"easy",hints:["Bun","Patty"]},
  {word:"Sandwich",topic:"Food",category:"food",difficulty:"easy",hints:["Bread","Fillings"]},
  {word:"Pasta",topic:"Food",category:"food",difficulty:"easy",hints:["Noodles","Sauce"]},
  {word:"Cake",topic:"Food",category:"food",difficulty:"easy",hints:["Icing","Slice"]},
  {word:"Sushi",topic:"Food",category:"food",difficulty:"medium",hints:["Rice","Roll"]},
  {word:"Curry",topic:"Food",category:"food",difficulty:"medium",hints:["Spice","Sauce"]},
  {word:"Falafel",topic:"Food",category:"food",difficulty:"medium",hints:["Chickpea","Wrap"]},
  {word:"Quiche",topic:"Food",category:"food",difficulty:"medium",hints:["Egg","Pastry"]},
  {word:"Dumplings",topic:"Food",category:"food",difficulty:"medium",hints:["Filling","Steamed"]},
  {word:"Brioche",topic:"Food",category:"food",difficulty:"hard",hints:["Butter","Bakery"]},
  {word:"Ratatouille",topic:"Food",category:"food",difficulty:"hard",hints:["Vegetable","French"]},
  {word:"Gazpacho",topic:"Food",category:"food",difficulty:"hard",hints:["Cold","Soup"]},
  {word:"Kimchi",topic:"Food",category:"food",difficulty:"hard",hints:["Fermented","Spicy"]},
  {word:"Tiramisu",topic:"Food",category:"food",difficulty:"hard",hints:["Coffee","Layers"]},

  // Sports
  {word:"Football",topic:"Sports",category:"sports",difficulty:"easy",hints:["Goal","Pitch"]},
  {word:"Basketball",topic:"Sports",category:"sports",difficulty:"easy",hints:["Hoop","Dribble"]},
  {word:"Tennis",topic:"Sports",category:"sports",difficulty:"easy",hints:["Racket","Court"]},
  {word:"Rugby",topic:"Sports",category:"sports",difficulty:"easy",hints:["Try","Scrum"]},
  {word:"Swimming",topic:"Sports",category:"sports",difficulty:"easy",hints:["Pool","Stroke"]},
  {word:"Cricket",topic:"Sports",category:"sports",difficulty:"medium",hints:["Wicket","Bat"]},
  {word:"Badminton",topic:"Sports",category:"sports",difficulty:"medium",hints:["Shuttle","Net"]},
  {word:"Hockey",topic:"Sports",category:"sports",difficulty:"medium",hints:["Stick","Ice/Field"]},
  {word:"Volleyball",topic:"Sports",category:"sports",difficulty:"medium",hints:["Spike","Net"]},
  {word:"Boxing",topic:"Sports",category:"sports",difficulty:"medium",hints:["Ring","Gloves"]},
  {word:"Biathlon",topic:"Sports",category:"sports",difficulty:"hard",hints:["Ski","Rifle"]},
  {word:"Dressage",topic:"Sports",category:"sports",difficulty:"hard",hints:["Horse","Routine"]},
  {word:"Curling",topic:"Sports",category:"sports",difficulty:"hard",hints:["Stone","Sweep"]},
  {word:"Pentathlon",topic:"Sports",category:"sports",difficulty:"hard",hints:["Five","Events"]},
  {word:"Archery",topic:"Sports",category:"sports",difficulty:"hard",hints:["Bow","Target"]},

  // Geography
  {word:"Desert",topic:"Geography",category:"geography",difficulty:"easy",hints:["Sand","Dunes"]},
  {word:"Mountain",topic:"Geography",category:"geography",difficulty:"easy",hints:["Peak","Climb"]},
  {word:"River",topic:"Geography",category:"geography",difficulty:"easy",hints:["Flow","Bank"]},
  {word:"Island",topic:"Geography",category:"geography",difficulty:"easy",hints:["Sea","Coast"]},
  {word:"Forest",topic:"Geography",category:"geography",difficulty:"easy",hints:["Trees","Wild"]},
  {word:"Volcano",topic:"Geography",category:"geography",difficulty:"medium",hints:["Lava","Erupt"]},
  {word:"Glacier",topic:"Geography",category:"geography",difficulty:"medium",hints:["Ice","Slow"]},
  {word:"Canyon",topic:"Geography",category:"geography",difficulty:"medium",hints:["Cliffs","Deep"]},
  {word:"Plateau",topic:"Geography",category:"geography",difficulty:"medium",hints:["Flat","High"]},
  {word:"Oasis",topic:"Geography",category:"geography",difficulty:"medium",hints:["Water","Desert"]},
  {word:"Archipelago",topic:"Geography",category:"geography",difficulty:"hard",hints:["Islands","Group"]},
  {word:"Isthmus",topic:"Geography",category:"geography",difficulty:"hard",hints:["Narrow","Land"]},
  {word:"Delta",topic:"Geography",category:"geography",difficulty:"hard",hints:["River","Mouth"]},
  {word:"Fjord",topic:"Geography",category:"geography",difficulty:"hard",hints:["Sea","Cliffs"]},
  {word:"Atoll",topic:"Geography",category:"geography",difficulty:"hard",hints:["Coral","Ring"]},

  // Technology
  {word:"Keyboard",topic:"Technology",category:"technology",difficulty:"easy",hints:["Keys","Typing"]},
  {word:"Mouse",topic:"Technology",category:"technology",difficulty:"easy",hints:["Pointer","Click"]},
  {word:"Screen",topic:"Technology",category:"technology",difficulty:"easy",hints:["Display","Pixels"]},
  {word:"Printer",topic:"Technology",category:"technology",difficulty:"easy",hints:["Ink","Paper"]},
  {word:"Wi-Fi",topic:"Technology",category:"technology",difficulty:"easy",hints:["Wireless","Network"]},
  {word:"Router",topic:"Technology",category:"technology",difficulty:"medium",hints:["Packets","DHCP"]},
  {word:"Database",topic:"Technology",category:"technology",difficulty:"medium",hints:["Tables","Query"]},
  {word:"Browser",topic:"Technology",category:"technology",difficulty:"medium",hints:["Tabs","Web"]},
  {word:"Server",topic:"Technology",category:"technology",difficulty:"medium",hints:["Host","Requests"]},
  {word:"Firewall",topic:"Technology",category:"technology",difficulty:"medium",hints:["Filter","Ports"]},
  {word:"Algorithm",topic:"Technology",category:"technology",difficulty:"hard",hints:["Steps","Logic"]},
  {word:"Blockchain",topic:"Technology",category:"technology",difficulty:"hard",hints:["Ledger","Blocks"]},
  {word:"Compiler",topic:"Technology",category:"technology",difficulty:"hard",hints:["Code","Build"]},
  {word:"Encryption",topic:"Technology",category:"technology",difficulty:"hard",hints:["Cipher","Keys"]},
  {word:"API",topic:"Technology",category:"technology",difficulty:"hard",hints:["Interface","Calls"]},

  // Movies
  {word:"Superhero",topic:"Movies",category:"movies",difficulty:"easy",hints:["Cape","Power"]},
  {word:"Villain",topic:"Movies",category:"movies",difficulty:"easy",hints:["Evil","Antagonist"]},
  {word:"Actor",topic:"Movies",category:"movies",difficulty:"easy",hints:["Role","Cast"]},
  {word:"Scene",topic:"Movies",category:"movies",difficulty:"easy",hints:["Shot","Set"]},
  {word:"Popcorn",topic:"Movies",category:"movies",difficulty:"easy",hints:["Snack","Bucket"]},
  {word:"Sequel",topic:"Movies",category:"movies",difficulty:"medium",hints:["Next","Part"]},
  {word:"Director",topic:"Movies",category:"movies",difficulty:"medium",hints:["Set","Vision"]},
  {word:"Script",topic:"Movies",category:"movies",difficulty:"medium",hints:["Dialogue","Pages"]},
  {word:"Trailer",topic:"Movies",category:"movies",difficulty:"medium",hints:["Preview","Tease"]},
  {word:"Soundtrack",topic:"Movies",category:"movies",difficulty:"medium",hints:["Music","Score"]},
  {word:"Montage",topic:"Movies",category:"movies",difficulty:"hard",hints:["Sequence","Edit"]},
  {word:"Cinematography",topic:"Movies",category:"movies",difficulty:"hard",hints:["Camera","Lighting"]},
  {word:"Cameo",topic:"Movies",category:"movies",difficulty:"hard",hints:["Brief","Appearance"]},
  {word:"Screenplay",topic:"Movies",category:"movies",difficulty:"hard",hints:["Script","Structure"]},
  {word:"Franchise",topic:"Movies",category:"movies",difficulty:"hard",hints:["Series","Brand"]},

  // Music
  {word:"Guitar",topic:"Music",category:"music",difficulty:"easy",hints:["Strings","Pick"]},
  {word:"Piano",topic:"Music",category:"music",difficulty:"easy",hints:["Keys","Pedal"]},
  {word:"Drum",topic:"Music",category:"music",difficulty:"easy",hints:["Beat","Stick"]},
  {word:"Singer",topic:"Music",category:"music",difficulty:"easy",hints:["Voice","Vocal"]},
  {word:"Song",topic:"Music",category:"music",difficulty:"easy",hints:["Lyrics","Tune"]},
  {word:"Tempo",topic:"Music",category:"music",difficulty:"medium",hints:["Speed","BPM"]},
  {word:"Melody",topic:"Music",category:"music",difficulty:"medium",hints:["Tune","Lead"]},
  {word:"Harmony",topic:"Music",category:"music",difficulty:"medium",hints:["Chord","Blend"]},
  {word:"Choir",topic:"Music",category:"music",difficulty:"medium",hints:["Group","Sing"]},
  {word:"Festival",topic:"Music",category:"music",difficulty:"medium",hints:["Stage","Crowd"]},
  {word:"Polyrhythm",topic:"Music",category:"music",difficulty:"hard",hints:["Overlap","Timing"]},
  {word:"Crescendo",topic:"Music",category:"music",difficulty:"hard",hints:["Grow","Louder"]},
  {word:"Fugue",topic:"Music",category:"music",difficulty:"hard",hints:["Counterpoint","Baroque"]},
  {word:"Overture",topic:"Music",category:"music",difficulty:"hard",hints:["Opening","Orchestra"]},
  {word:"Syncopation",topic:"Music",category:"music",difficulty:"hard",hints:["Off‑beat","Accent"]},

  // Animals
  {word:"Dog",topic:"Animals",category:"animals",difficulty:"easy",hints:["Pet","Bark"]},
  {word:"Cat",topic:"Animals",category:"animals",difficulty:"easy",hints:["Meow","Whiskers"]},
  {word:"Cow",topic:"Animals",category:"animals",difficulty:"easy",hints:["Milk","Farm"]},
  {word:"Horse",topic:"Animals",category:"animals",difficulty:"easy",hints:["Mane","Ride"]},
  {word:"Sheep",topic:"Animals",category:"animals",difficulty:"easy",hints:["Wool","Flock"]},
  {word:"Penguin",topic:"Animals",category:"animals",difficulty:"medium",hints:["Ice","Waddle"]},
  {word:"Kangaroo",topic:"Animals",category:"animals",difficulty:"medium",hints:["Pouch","Jump"]},
  {word:"Tiger",topic:"Animals",category:"animals",difficulty:"medium",hints:["Stripes","Big cat"]},
  {word:"Dolphin",topic:"Animals",category:"animals",difficulty:"medium",hints:["Smart","Ocean"]},
  {word:"Eagle",topic:"Animals",category:"animals",difficulty:"medium",hints:["Wings","Soar"]},
  {word:"Axolotl",topic:"Animals",category:"animals",difficulty:"hard",hints:["Salamander","Smile"]},
  {word:"Platypus",topic:"Animals",category:"animals",difficulty:"hard",hints:["Beak","Weird"]},
  {word:"Narwhal",topic:"Animals",category:"animals",difficulty:"hard",hints:["Tusk","Arctic"]},
  {word:"Chameleon",topic:"Animals",category:"animals",difficulty:"hard",hints:["Color","Change"]},
  {word:"Armadillo",topic:"Animals",category:"animals",difficulty:"hard",hints:["Armor","Roll"]},

  // Household
  {word:"Sofa",topic:"Household",category:"household",difficulty:"easy",hints:["Cushion","Seat"]},
  {word:"Chair",topic:"Household",category:"household",difficulty:"easy",hints:["Sit","Legs"]},
  {word:"Bed",topic:"Household",category:"household",difficulty:"easy",hints:["Sleep","Pillow"]},
  {word:"Lamp",topic:"Household",category:"household",difficulty:"easy",hints:["Light","Shade"]},
  {word:"Table",topic:"Household",category:"household",difficulty:"easy",hints:["Eat","Surface"]},
  {word:"Microwave",topic:"Household",category:"household",difficulty:"medium",hints:["Heat","Timer"]},
  {word:"Vacuum",topic:"Household",category:"household",difficulty:"medium",hints:["Clean","Dust"]},
  {word:"Fridge",topic:"Household",category:"household",difficulty:"medium",hints:["Cold","Food"]},
  {word:"Curtain",topic:"Household",category:"household",difficulty:"medium",hints:["Window","Drape"]},
  {word:"Mirror",topic:"Household",category:"household",difficulty:"medium",hints:["Reflect","Glass"]},
  {word:"Decanter",topic:"Household",category:"household",difficulty:"hard",hints:["Pour","Wine"]},
  {word:"Chandelier",topic:"Household",category:"household",difficulty:"hard",hints:["Ceiling","Crystals"]},
  {word:"Ottoman",topic:"Household",category:"household",difficulty:"hard",hints:["Footrest","Seat"]},
  {word:"Wardrobe",topic:"Household",category:"household",difficulty:"hard",hints:["Clothes","Doors"]},
  {word:"Tapestry",topic:"Household",category:"household",difficulty:"hard",hints:["Wall","Woven"]},
];

/* =========================
   State & helpers
   ========================= */
let players = [];
let impostorIndices = new Set();
let selectedWord = null;
let starterIndex = null;
let secs = 8;

const $ = id => document.getElementById(id);
const randInt = n => Math.floor(Math.random()*n);
const sample = arr => arr[randInt(arr.length)];
const shuffle = arr => { for(let i=arr.length-1;i>0;i--){const j=randInt(i+1); [arr[i],arr[j]]=[arr[j],arr[i]]} return arr };
const clamp = (x,min,max) => Math.max(min,Math.min(max,x));

/* =========================
   Screen navigation
   ========================= */
const show = id => {
  document.querySelectorAll('.screen').forEach(s=>s.classList.remove('active'));
  $(id).classList.add('active');
}

/* =========================
   Setup and round logic
   ========================= */
function parsePlayers(){
  players = $('names').value.split('\n').map(s=>s.trim()).filter(Boolean);
  return players;
}
function validate(n, k){
  const errs=[];
  if(n<3) errs.push('Add at least 3 players.');
  if(!Number.isFinite(k)||k<1) errs.push('Impostors must be ≥ 1.');
  if(k>=n) errs.push('Impostors must be fewer than players.');
  return errs;
}
function assignImpostors(n,k){
  impostorIndices = new Set();
  const ix = shuffle([...Array(n).keys()]);
  for(let i=0;i<k;i++) impostorIndices.add(ix[i]);
}
function pickWord(category,difficulty){
  const pool = WORDS.filter(w => (category==='any'||w.category===category) && (difficulty? w.difficulty===difficulty : true));
  return pool.length ? sample(pool) : null;
}

/* =========================
   Reveal overlay
   ========================= */
let countdownTimer=null;
function openReveal(){
  const idx = parseInt($('revealPlayer').value,10);
  if(!Number.isFinite(idx) || idx<0 || idx>=players.length) return;
  const isImp = impostorIndices.has(idx);
  $('revealWho').textContent = players[idx];
  $('revealRole').textContent = isImp ? 'IMPOSTER' : 'Civilian';
  const hintToggle = $('roundHints').value === 'on';

  $('infoLabel').textContent = isImp ? 'General topic' : 'Secret word';
  $('revealInfo').textContent = isImp ? selectedWord.topic : selectedWord.word;

  // Optional hint for impostor
  const showHint = isImp && hintToggle && selectedWord.hints && selectedWord.hints.length;
  $('hintBox').style.display = showHint ? 'block' : 'none';
  $('revealHint').textContent = showHint ? sample(selectedWord.hints) : '—';

  secs = clamp(parseInt($('timerSecs').value,10)||8,4,20);
  $('revealCount').textContent = `Auto-hide in ${secs}s`;
  $('overlay').classList.add('show');
  clearInterval(countdownTimer);
  countdownTimer = setInterval(()=>{
    secs--; $('revealCount').textContent = `Auto-hide in ${secs}s`;
    if(secs<=0) closeReveal();
  },1000);
}
function closeReveal(){
  $('overlay').classList.remove('show');
  clearInterval(countdownTimer);
}

/* =========================
   Event wiring
   ========================= */
$('toSetup').addEventListener('click', ()=> show('screen-setup'));
$('backToSetup').addEventListener('click', ()=> show('screen-setup'));

$('clearPlayers').addEventListener('click', ()=>{
  $('names').value='';
  players=[]; impostorIndices.clear();
  selectedWord=null; starterIndex=null;
  $('setupStatus').innerHTML = '<span class="tag">Cleared.</span>';
  $('revealPlayer').innerHTML = '';
  $('tagPlayers').textContent='—';
  $('tagImps').textContent='—';
  $('tagCat').textContent='—';
  $('tagDiff').textContent='—';
  $('tagStarter').textContent='—';
});

$('startRound').addEventListener('click', ()=>{
  const n = parsePlayers().length;
  const k = parseInt($('impostors').value,10);
  const category = $('category').value;
  const difficulty = $('difficulty').value;
  const starterPref = $('starterPref').value;

  const errors = validate(n,k);
  $('setupStatus').innerHTML='';
  if(errors.length){
    errors.forEach(e=>{
      const el=document.createElement('span'); el.className='tag'; el.textContent=e; $('setupStatus').appendChild(el);
    });
    return;
  }

  assignImpostors(n, clamp(k,1,n-1));
  selectedWord = pickWord(category,difficulty);
  if(!selectedWord){
    $('setupStatus').innerHTML = '<span class="tag">No words for that category/difficulty.</span>';
    return;
  }

  starterIndex = starterPref==='first' ? 0 : randInt(n);

  // Fill reveal selector
  const sel = $('revealPlayer');
  sel.innerHTML='';
  players.forEach((p,i)=>{
    const opt=document.createElement('option'); opt.value=String(i); opt.textContent=p; sel.appendChild(opt);
  });

  // Update tags
  $('tagPlayers').textContent = n;
  $('tagImps').textContent = impostorIndices.size;
  $('tagCat').textContent = selectedWord.topic + (category!=='any'? ` (${category})` : '');
  $('tagDiff').textContent = difficulty;
  $('tagStarter').textContent = players[starterIndex];

  $('setupStatus').innerHTML = '<span class="tag">Round ready</span><span class="tag">Word selected: hidden</span><span class="tag">Starter: '+players[starterIndex]+'</span>';
});

$('openReveal').addEventListener('click', openReveal);
$('closeReveal').addEventListener('click', closeReveal);

$('toRound').addEventListener('click', ()=>{
  if(!players.length || !selectedWord){ return; }
  $('roundStarter').textContent = players[starterIndex];
  $('roundImps').textContent = impostorIndices.size;
  $('roundCat').textContent = selectedWord.topic;
  $('roundDiff').textContent = $('difficulty').value;
  show('screen-round');
});
</script>
</body>
</html>
